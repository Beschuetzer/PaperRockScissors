<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="container_content">
        <h2>Simple Rock Paper Scissors (or is it?)</h2>
        <div class="content">
            <div class="round_text">
                <label for="textbox_number_of_games">Number of Rounds to Play:</label>
                <input id="textbox_number_of_games" sty type="text">
                <p id="p_CurrentRound">Current Round: 0</p>
            </div>
            <div class="btn_start">
                <button id="btn_start" class="btn_default" onclick="game()">Start Game</button>
            </div>
            <div class="choice_stuff">
                <p id="instructions">Input Number of Rounds to Play and Hit 'Start Game'</p>
                <div class="choice_buttons">
                    <button id="btn_rock" class="btn_default btn_choice">Rock</button>
                    <button id="btn_paper" class="btn_default btn_choice">Paper</button>
                    <button id="btn_scissors" class="btn_default btn_choice">Scissors</button>
                </div>
            </div>
            <div class="scoring">
                <div class="your_scores">
                    <p class="your_score">Your Score:</p>
                    <p id="human_score" class="your_score">0</p>
                </div>
                <div class="computer_scores">
                    <p id="computer_score">Computer Score:</p>
                    <p id="computer_score" class="computer_score">0</p>
                </div>
                <div class="your_score_details">
                    <div class="your_wins">
                        <p class="score_detail">Wins:</p>
                        <p id="your_wins" class="score_detail">0</p>
                    </div>
                    <div class="your_ties">
                        <p class="score_detail">Ties:</p>
                        <p id="your_ties" class="score_detail">0</p>
                    </div>
                    <div class="your_losses">
                        <p class="score_detail">Losses:</p>
                        <p id="your_losses" class="score_detail">0</p>
                    </div>
                </div>
                <div class="computer_score_details">
                    <div class="computer_wins">
                        <p class="score_detail">Wins:</p>
                        <p id="computer_wins" class="score_detail">0</p>
                    </div>
                    <div class="computer_wins">
                        <p class="score_detail">Ties:</p>
                        <p id="computer_ties" class="score_detail">0</p>
                    </div>
                    <div class="computer_wins">
                        <p class="score_detail">Losses:</p>
                        <p id="computer_losses" class="score_detail">0</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<script>    

    //#region Helper Functions 
    const playsenum =
    {
        Rock: 'rock',
        Paper: 'paper',
        Scissors: 'scissors'
    } 
    let plays = [playsenum.Rock, playsenum.Paper, playsenum.Scissors];
    function random(number){
        let res = Math.floor(Math.random()*number);
        return res;
    }
    function assert(condition, message) {
        if (!condition) {
            message = message || "Assertion failed";
            alert(message);
            if (typeof Error !== "undefined") {
                throw new Error(message);
            }
            throw message; // Fallback
        }
    }
    //#endregion
    //#region Main Functions
    //get the human choice
    function getHumanPlayOld(){
        let ans = "", promptMsg = "Rock, Paper, or scissors?";
        let shouldContinue = false;
        while (shouldContinue == false){
            ans = prompt(promptMsg);
            if (ans.match(/^\s*scissor\s*$|^\s*rock\s*$|^\s*paper\s*$/)) {
                shouldContinue = true;
            }
            promptMsg = `${ans} is not a valid option.  Type "rock", "paper", or "scissors".`;
        }
        return ans.trim();
    }
    function getHumanPlay(e){
        console.log(e.srcElement.textContent);
        return e.srcElement.textContent.trim();
    }
    function stopGame(e){
        console.log(e.srcElement.textContent);
        if (e.srcElement.textContent === 'Stop') {return null}
        //find a way to stop 
    }
    //computer picks an option
    function computerPlay () {
        return plays[random(plays.length)];
    }
    //play one round 
    function playOneRound (playerSelection, computerSelection){
        let msg, winningChoice, losingChoice, outcome = "";
        switch (playerSelection.toLowerCase()) {
            case playsenum.Rock:
                if (computerSelection === playsenum.Scissors) {
                    msg = "You win! :)";
                    winningChoice = playerSelection;
                    losingChoice = computerSelection;
                }
                else if (computerSelection === playsenum.Paper)  {
                    msg = "You lose :(!";
                    winningChoice = computerSelection;
                    losingChoice = playerSelection;
                }
                else if (playerSelection.toLowerCase() == computerSelection.toLowerCase()) {
                    msg = `Looks like a tie.  You both chose ${playerSelection}`;
                    outcome = "tie";
                }
            break;
            case playsenum.Paper:
                if (computerSelection === playsenum.Rock) {
                    msg = "You win! :)";
                    winningChoice = playerSelection;
                    losingChoice = computerSelection;
                }
                else if (computerSelection === playsenum.Scissors)  {
                    msg = "You lose :(!";
                    winningChoice = computerSelection;
                    losingChoice = playerSelection;
                }
                else if (playerSelection.toLowerCase() == computerSelection.toLowerCase()) {
                    msg = `Looks like a tie.  You both chose ${playerSelection}`;
                    outcome = "tie";
                }
            break;
            case playsenum.Scissors:
                if (computerSelection === playsenum.Paper) {
                    msg = "You win! :)";
                    winningChoice = playerSelection;
                    losingChoice = computerSelection;
                }
                else if (computerSelection === playsenum.Rock)  {
                    msg = "You lose :(!";
                    winningChoice = computerSelection;
                    losingChoice = playerSelection;
                }
                else if (playerSelection.toLowerCase() == computerSelection.toLowerCase()) {
                    msg = `Looks like a tie.  You both chose ${playerSelection}`;
                    outcome = "tie";
                }
            break;
        }
        return (outcome != 'tie') ?  `${msg}.\n${winningChoice} beats ${losingChoice}` : msg;
    }
    //Returns a string showing the result of game
    function getGameResult(score, roundsPlayed){
        //positive score means player won by score amount of games.  Negative means computer and 0 means tie.
        alert(`final score: ${score} and roundsPlayed: ${roundsPlayed}`);
        assert(Math.abs(score) <= roundsPlayed, "The score must be less than or equal to roundsPlayed");
        let gameResult, playerScore, computerScore, scoreMessage;
        if (score == 0) {
            scoreMessage = 'Looks like we have a tie!';
        }
        else if (score > 0){
            scoreMessage = 'Humanity prevails THIS time';
        }
        else {
            scoreMessage = 'Was there ever really ANY doubt about machine superiority?';
        }
        playerScore = (roundsPlayed + score) /2;
        computerScore = roundsPlayed - playerScore
        return `Result of ${roundsPlayed} Round Game:\n\nYou won ${playerScore} games.\nThe computer won ${computerScore} games.\n\n${(scoreMessage)}`
    }
    //The main function that plays a game.
    function game() {
        const roundsPlayed = parseInt(document.getElementById('textbox_number_of_games').value);
        if (!roundsPlayed){
            alert("please enter an integer for the number of round you want to play");
            return null;
        }
        const btn_start = document.getElementById('btn_start');
        const btn_rock = document.getElementById('btn_rock');
        const btn_paper = document.getElementById('btn_paper');
        const btn_scissors = document.getElementById('btn_scissors');
        const instructions = document.getElementById('instructions');
        btn_paper.addEventListener('click',getHumanPlay);
        btn_rock.addEventListener('click',getHumanPlay);
        btn_scissors.addEventListener('click',getHumanPlay);
        btn_start.addEventListener('click',stopGame);
        
        instructions.textContent = "Make a Selection Below:";
        btn_start.textContent = "Stop";
        btn_rock.classList.add('buttons_visible');
        btn_paper.classList.add('buttons_visible');
        btn_scissors.classList.add('buttons_visible');

        let score = 0;
        for (let index = 0; index < parseInt(roundsPlayed); index++) {
            // alert(`score: ${score}\nindex; ${index}\nroundsPlayed: ${roundsPlayed}\n index < roundsPlayed: ${index < roundsPlayed}`);
            let result = playOneRound(getHumanPlay(),computerPlay());
            alert(`${result}`);
            if (result.match('win')) {
                score += 1;
                //alert('won');
            }
            else if (result.match('lose')) {
                score -= 1;
                //alert('lost');
            }
            else {
                score += 0;
                //alert('tie');
            }
        }
        return getGameResult(score, roundsPlayed);
    }
    //#endregion
</script>